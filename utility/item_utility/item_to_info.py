window_data = {
    "furnace": {
        "title": "Furnace",
        "description": "A blazing hot furnace. Right click to go to the Furnace!",
        "data": {},
    },
    "anvil": {
        "title": "Anvil",
        "description": "A shiny anvil. Right click to go to the Anvil!",
        "data": {},
    },
    "map": {
        "title": "Map",
        "description": "Allows travel to islands. Right click to open the map!",
        "data": {},
    },
    "craft": {
        "title": "Craft",
        "description": "Right click to go to the Workstation!",
        "data": {},
    },
    "map_boat": {
        "title": "Your Boat",
        "description": "This is your boat.",
        "data": {},
    },
    "island1": {
        "title": "placeholder island",
        "description": "island where dreams come true i think",
        "data": {},
    },
    "copper_ore": {
        "title": "Copper Ore",
        "description": "Copper ore is a native metal, which means it can be used without importantoying or refining. It is rather soft, but can be easily forged and therefore is a perfect starter metal for beginners.",
        "data": {"mass":"number", "impurities":"percent"},
    },
    "copper_ingot": {
        "title": "Copper Ingot",
        "description": "A solid bar of copper. Can be forged after heating.",
        "data": {"mass":"number", "temperature":"number", "impurities":"percent"},
    },
    "iron_ore": {
        "title": "Iron Ore",
        "description": "Iron ore is a common metal, with higher strength than copper. However, it requires hotter temperatures to forge, requiring more fuel or higher forge efficiency.",
        "data": {"mass":"number", "impurities":"percent"},
    },
    "iron_ingot": {
        "title": "Iron Ingot",
        "description": "A solid bar of Iron. As carbon is added, strength increases, forming high carbon steel. adding too much can result in the compound weakening.",
        "data": {"mass":"number", "temperature":"number", "impurities":"percent"},
    },
    "lead_ore": {
        "title": "Lead Ore",
        "description": "Lead is a very dense metal. It's the end of many major nuclear chains, and can hold magic easier due to high proton count.",
        "data": {"mass":"number", "impurities":"percent"},
    },
    "lead_ingot": {
        "title": "Lead Ingot",
        "description": "Denser metals hold magic easier. Therefore, lead is perfect for magically infused items.",
        "data": {"mass":"number", "temperature":"number", "impurities":"percent"},
    },
    "lomium_ore": {
        "title": "Lomium Ore",
        "description": "Lomium, despite it's appearance, is a strong crystalline structure. It's a metal that smells sweetly of sugar, and has high tensile strength at base without being treated.",
        "data": {"mass":"number", "impurities":"percent"}, # in the future, i can show impurities as cloudiness in the metal, or add specks or some opacity layer.
    },
    "lomium_ingot": {
        "title": "Lomium Ingot",
        "description": "A strong, dense, and lightweight metal. forging it can be an issue, due to it's small forging temperature window, However the results when properly forged speak for themselves.",
        "data": {"mass":"number", "temperature":"number", "impurities":"percent"},
    },
    "silver_ore": {
        "title": "Silver Ore",
        "description": "Silver is a shiny, lustrous metal, that's stronger than copper and incredibly valuable.",
        "data": {"mass":"number", "impurities":"percent"}, 
    },
    "silver_ingot": {
        "title": "Silver Ingot",
        "description": "A solid silver ingot. It's rarity and beauty makes it perfect for jewelry and decorative pieces, aswell as having a strong effect on certain monsters.",
        "data": {"mass":"number", "temperature":"number", "impurities":"percent"},
    },
    "titanium_ore": {
        "title": "Titanium Ore",
        "description": "Titanium has the highest strength to weight ratio of any metal, however lacks the hardness to maintain an edge.",
        "data": {"mass":"number", "impurities":"percent"}, 
    },
    "titanium_ingot": {
        "title": "Titanium Ingot",
        "description": "Titanium is a strong metal, but lacks the ability to maintain an edge. It can also be anodized, which can increase value substantially.",
        "data": {"mass":"number", "temperature":"number", "impurities":"percent"},
    },
    "anodized_titanium_ingot": {
        "title": "Anodized Titanium Ingot",
        "description": "A titanium ingot anodized with heat or electricity. It has bright colors and is strongly sought after because of it.",
        "data": {"mass":"number", "temperature":"number", "impurities":"percent"},
    },
    "large_coal": {
        "title": "Large Coal",
        "description": "A large deposit of coal. Can be put in the furnace.",
        "data": {"fuel":"number"},
    },
    "medium_coal": {
        "title": "Medium Coal",
        "description": "A medium deposit of coal. Can be put in the furnace.",
        "data": {"fuel":"number"},
    },
    "small_coal": {
        "title": "Small Coal",
        "description": "A small deposit of coal. Can be put in the furnace.",
        "data": {"fuel":"number"},
    },
    "log": {
        "title": "Log",
        "description": "A hefty log. Can be put in the furnace.",
        "data": {"fuel":"number"},
    },
    ######## BOTTLES ############
    "large_bottle": {
        "title": "Large Bottle",
        "description": "A bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "hexagon_bottle": {
        "title": "Hexagon Bottle",
        "description": "A bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "gold_bottle": {
        "title": "Gold Bottle",
        "description": "An enchanted bottle. Can store all liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "crescent_bottle": {
        "title": "Crescent Bottle",
        "description": "A bottle with an embedded amethyst. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "circle_bottle": {
        "title": "Circle Bottle",
        "description": "A bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "spiked_bottle": {
        "title": "Spiked Bottle",
        "description": "A bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "uranium_bottle": {
        "title": "Uranium Bottle",
        "description": "A bottle made from uranium glass. Can store most liquids. May have slight side effects.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "tall_bottle": {
        "title": "Tall Bottle",
        "description": "A bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "small_uranium_bottle": {
        "title": "Tall Bottle",
        "description": "A bottle made from uranium glass. Can store most liquids. May have slight side effects.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "small_bottle": {
        "title": "Small Bottle",
        "description": "A bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "red_bottle": {
        "title": "Red Bottle",
        "description": "An intricate bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "mini_bottle": {
        "title": "Mini Bottle",
        "description": "A very small bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "brown_bottle": {
        "title": "Brown Bottle",
        "description": "A bottle. Can store most liquids.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    "chain_bottle": {
        "title": "Chain Bottle",
        "description": "An enchanted bottle. Can store most liquids. can also capture mythical beasts.",
        "data": {"capacity":"number", "contents":"number", "liquid":"number"},
    },
    ###### GEMS #########
    "aquamarine": {
        "title": "Aquamarine",
        "description": "A shiny light blue gem.",
        "data": {"mass":"number", "quality":"percent", "element":"highlight"},
    },
    "citrine": {
        "title": "Citrine",
        "description": "A shiny pale orange gem.",
        "data": {"mass":"number", "quality":"percent", "element":"highlight"},
    },
    "emerald": {
        "title": "Emerald.",
        "description": "A shiny green gem.",
        "data": {"mass":"number", "quality":"percent", "element":"highlight"},
    },
    "rhotochrosite": {
        "title": "Rhotochrosite",
        "description": "A shiny light pink gem.",
        "data": {"mass":"number", "quality":"percent", "element":"highlight"},
    },
    "tourmaline": {
        "title": "Tourmaline",
        "description": "A shiny red gem.",
        "data": {"mass":"number", "quality":"percent", "element":"highlight"},
    },
    "flawless_tourmaline": {
        "title": "Flawless Tourmaline",
        "description": "A gemstone cut by a master craftsman.",
        "data": {"mass":"number", "quality":"percent", "element":"highlight", "bonus":"percent"},
    },
    ##### PARTS #####
    "rounded_pommel": {
        "title": "Rounded Pommel",
        "description": "A basic pommel.",
        "data": {"material":"highlight", "quality":"percent"},
    },
    ##### ISLANDS #####
}
from utility.animated_sprite import AnimatedTile
from utility.gui_utility.hoverWindow import *

placeholder = {
    "title":"???",
    "description":"an item with no description. probably a bug."
}

def item_to_info(item, inspecting):
    item_name = getattr(item, "item_name", "No Item Name")
    if item_name in window_data:
        data_entry = window_data[item_name]
    else:
        print(f"[ITEM_TO_INFO.py] item '{item_name}' not in window_data. Using placeholder.")
        data_entry = placeholder

    hover_data = []
    reduced_data = []

    # Basic info
    title = data_entry.get("title", item_name)
    description = data_entry.get("description", "")

    # Parse data dictionary into HoverData
    item_data = data_entry.get("data", {})
    for label, dtype in item_data.items():
        value = getattr(item, label, "N/A")
        if value == "N/A":
            continue

        # If highlight, we expect the value to be an AnimatedTile or a path to one
        anim_tile = None
        if dtype == "highlight":
            # Try to load the animated tile if value is a path
            if isinstance(value, str):
                try:
                    anim_tile = get_highlight(value)
                except Exception as e:
                    print(f"[ITEM_TO_INFO.py] Could not load AnimatedTile from '{value}': {e}")
            elif isinstance(value, AnimatedTile):
                anim_tile = value
            else:
                print(f"[ITEM_TO_INFO.py] Invalid highlight value for '{label}': {value}")

            hover_data.append(HoverData(label=label, data_type="highlight", anim_tile=anim_tile))

        elif dtype in ("number", "percent", "bar"):
            hover_data.append(HoverData(label=label, value=round(value, 1), data_type=dtype))

        else:
            # Fallback generic representation
            hover_data.append(HoverData(label=label, value=value, data_type="number"))

    return HoverInfo(
        title=title,
        description=description,
        icon=None,
        data=hover_data,
        reduced_data=reduced_data,
        mode="default" if inspecting else "reduced"
    )


highlights = {
    "default":"assets/items/highlights/default"
}

def get_highlight(name):
    for key, value in highlights:
        if key == name:
            return AnimatedTile(value, 300)
    return AnimatedTile(highlights["default"], 300)